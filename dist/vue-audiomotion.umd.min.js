(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["vue-audiomotion"]=e():t["vue-audiomotion"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fb15")}({"0366":function(t,e,i){var n=i("1c0b");t.exports=function(t,e,i){if(n(t),void 0===e)return t;switch(i){case 0:return function(){return t.call(e)};case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,s){return t.call(e,i,n,s)}}return function(){return t.apply(e,arguments)}}},"06cf":function(t,e,i){var n=i("83ab"),s=i("d1e7"),r=i("5c6c"),a=i("fc6a"),o=i("c04e"),c=i("5135"),h=i("0cfb"),l=Object.getOwnPropertyDescriptor;e.f=n?l:function(t,e){if(t=a(t),e=o(e,!0),h)try{return l(t,e)}catch(i){}if(c(t,e))return r(!s.f.call(t,e),t[e])}},"0cfb":function(t,e,i){var n=i("83ab"),s=i("d039"),r=i("cc12");t.exports=!n&&!s((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},"159b":function(t,e,i){var n=i("da84"),s=i("fdbc"),r=i("17c2"),a=i("9112");for(var o in s){var c=n[o],h=c&&c.prototype;if(h&&h.forEach!==r)try{a(h,"forEach",r)}catch(l){h.forEach=r}}},"17c2":function(t,e,i){"use strict";var n=i("b727").forEach,s=i("a640"),r=i("ae40"),a=s("forEach"),o=r("forEach");t.exports=a&&o?[].forEach:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}},"1c0b":function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},"1d80":function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},"23cb":function(t,e,i){var n=i("a691"),s=Math.max,r=Math.min;t.exports=function(t,e){var i=n(t);return i<0?s(i+e,0):r(i,e)}},"23e7":function(t,e,i){var n=i("da84"),s=i("06cf").f,r=i("9112"),a=i("6eeb"),o=i("ce4e"),c=i("e893"),h=i("94ca");t.exports=function(t,e){var i,l,u,f,d,_,p=t.target,v=t.global,g=t.stat;if(l=v?n:g?n[p]||o(p,{}):(n[p]||{}).prototype,l)for(u in e){if(d=e[u],t.noTargetGet?(_=s(l,u),f=_&&_.value):f=l[u],i=h(v?u:p+(g?".":"#")+u,t.forced),!i&&void 0!==f){if(typeof d===typeof f)continue;c(d,f)}(t.sham||f&&f.sham)&&r(d,"sham",!0),a(l,u,d,t)}}},"241c":function(t,e,i){var n=i("ca84"),s=i("7839"),r=s.concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,r)}},4160:function(t,e,i){"use strict";var n=i("23e7"),s=i("17c2");n({target:"Array",proto:!0,forced:[].forEach!=s},{forEach:s})},"428f":function(t,e,i){var n=i("da84");t.exports=n},"44ad":function(t,e,i){var n=i("d039"),s=i("c6b6"),r="".split;t.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==s(t)?r.call(t,""):Object(t)}:Object},4930:function(t,e,i){var n=i("d039");t.exports=!!Object.getOwnPropertySymbols&&!n((function(){return!String(Symbol())}))},"4d64":function(t,e,i){var n=i("fc6a"),s=i("50c4"),r=i("23cb"),a=function(t){return function(e,i,a){var o,c=n(e),h=s(c.length),l=r(a,h);if(t&&i!=i){while(h>l)if(o=c[l++],o!=o)return!0}else for(;h>l;l++)if((t||l in c)&&c[l]===i)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},"50c4":function(t,e,i){var n=i("a691"),s=Math.min;t.exports=function(t){return t>0?s(n(t),9007199254740991):0}},5135:function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},5692:function(t,e,i){var n=i("c430"),s=i("c6cd");(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:n?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},"56ef":function(t,e,i){var n=i("d066"),s=i("241c"),r=i("7418"),a=i("825a");t.exports=n("Reflect","ownKeys")||function(t){var e=s.f(a(t)),i=r.f;return i?e.concat(i(t)):e}},"5c6c":function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"65f0":function(t,e,i){var n=i("861d"),s=i("e8b5"),r=i("b622"),a=r("species");t.exports=function(t,e){var i;return s(t)&&(i=t.constructor,"function"!=typeof i||i!==Array&&!s(i.prototype)?n(i)&&(i=i[a],null===i&&(i=void 0)):i=void 0),new(void 0===i?Array:i)(0===e?0:e)}},"69f3":function(t,e,i){var n,s,r,a=i("7f9a"),o=i("da84"),c=i("861d"),h=i("9112"),l=i("5135"),u=i("f772"),f=i("d012"),d=o.WeakMap,_=function(t){return r(t)?s(t):n(t,{})},p=function(t){return function(e){var i;if(!c(e)||(i=s(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}};if(a){var v=new d,g=v.get,m=v.has,x=v.set;n=function(t,e){return x.call(v,t,e),e},s=function(t){return g.call(v,t)||{}},r=function(t){return m.call(v,t)}}else{var b=u("state");f[b]=!0,n=function(t,e){return h(t,b,e),e},s=function(t){return l(t,b)?t[b]:{}},r=function(t){return l(t,b)}}t.exports={set:n,get:s,has:r,enforce:_,getterFor:p}},"6eeb":function(t,e,i){var n=i("da84"),s=i("9112"),r=i("5135"),a=i("ce4e"),o=i("8925"),c=i("69f3"),h=c.get,l=c.enforce,u=String(String).split("String");(t.exports=function(t,e,i,o){var c=!!o&&!!o.unsafe,h=!!o&&!!o.enumerable,f=!!o&&!!o.noTargetGet;"function"==typeof i&&("string"!=typeof e||r(i,"name")||s(i,"name",e),l(i).source=u.join("string"==typeof e?e:"")),t!==n?(c?!f&&t[e]&&(h=!0):delete t[e],h?t[e]=i:s(t,e,i)):h?t[e]=i:a(e,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&h(this).source||o(this)}))},7418:function(t,e){e.f=Object.getOwnPropertySymbols},7839:function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},"7b0b":function(t,e,i){var n=i("1d80");t.exports=function(t){return Object(n(t))}},"7f9a":function(t,e,i){var n=i("da84"),s=i("8925"),r=n.WeakMap;t.exports="function"===typeof r&&/native code/.test(s(r))},"825a":function(t,e,i){var n=i("861d");t.exports=function(t){if(!n(t))throw TypeError(String(t)+" is not an object");return t}},"83ab":function(t,e,i){var n=i("d039");t.exports=!n((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},"861d":function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},8875:function(t,e,i){var n,s,r;(function(i,a){s=[],n=a,r="function"===typeof n?n.apply(e,s):n,void 0===r||(t.exports=r)})("undefined"!==typeof self&&self,(function(){function t(){if(document.currentScript)return document.currentScript;try{throw new Error}catch(u){var t,e,i,n=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,s=/@([^@]*):(\d+):(\d+)\s*$/gi,r=n.exec(u.stack)||s.exec(u.stack),a=r&&r[1]||!1,o=r&&r[2]||!1,c=document.location.href.replace(document.location.hash,""),h=document.getElementsByTagName("script");a===c&&(t=document.documentElement.outerHTML,e=new RegExp("(?:[^\\n]+?\\n){0,"+(o-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=t.replace(e,"$1").trim());for(var l=0;l<h.length;l++){if("interactive"===h[l].readyState)return h[l];if(h[l].src===a)return h[l];if(a===c&&h[l].innerHTML&&h[l].innerHTML.trim()===i)return h[l]}return null}}return t}))},8925:function(t,e,i){var n=i("c6cd"),s=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(t){return s.call(t)}),t.exports=n.inspectSource},"90e3":function(t,e){var i=0,n=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++i+n).toString(36)}},9112:function(t,e,i){var n=i("83ab"),s=i("9bf2"),r=i("5c6c");t.exports=n?function(t,e,i){return s.f(t,e,r(1,i))}:function(t,e,i){return t[e]=i,t}},"94ca":function(t,e,i){var n=i("d039"),s=/#|\.prototype\./,r=function(t,e){var i=o[a(t)];return i==h||i!=c&&("function"==typeof e?n(e):!!e)},a=r.normalize=function(t){return String(t).replace(s,".").toLowerCase()},o=r.data={},c=r.NATIVE="N",h=r.POLYFILL="P";t.exports=r},"9bf2":function(t,e,i){var n=i("83ab"),s=i("0cfb"),r=i("825a"),a=i("c04e"),o=Object.defineProperty;e.f=n?o:function(t,e,i){if(r(t),e=a(e,!0),r(i),s)try{return o(t,e,i)}catch(n){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},a640:function(t,e,i){"use strict";var n=i("d039");t.exports=function(t,e){var i=[][t];return!!i&&n((function(){i.call(null,e||function(){throw 1},1)}))}},a691:function(t,e){var i=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:i)(t)}},ae40:function(t,e,i){var n=i("83ab"),s=i("d039"),r=i("5135"),a=Object.defineProperty,o={},c=function(t){throw t};t.exports=function(t,e){if(r(o,t))return o[t];e||(e={});var i=[][t],h=!!r(e,"ACCESSORS")&&e.ACCESSORS,l=r(e,0)?e[0]:c,u=r(e,1)?e[1]:void 0;return o[t]=!!i&&!s((function(){if(h&&!n)return!0;var t={length:-1};h?a(t,1,{enumerable:!0,get:c}):t[1]=1,i.call(t,l,u)}))}},b0c0:function(t,e,i){var n=i("83ab"),s=i("9bf2").f,r=Function.prototype,a=r.toString,o=/^\s*function ([^ (]*)/,c="name";n&&!(c in r)&&s(r,c,{configurable:!0,get:function(){try{return a.call(this).match(o)[1]}catch(t){return""}}})},b622:function(t,e,i){var n=i("da84"),s=i("5692"),r=i("5135"),a=i("90e3"),o=i("4930"),c=i("fdbf"),h=s("wks"),l=n.Symbol,u=c?l:l&&l.withoutSetter||a;t.exports=function(t){return r(h,t)||(o&&r(l,t)?h[t]=l[t]:h[t]=u("Symbol."+t)),h[t]}},b727:function(t,e,i){var n=i("0366"),s=i("44ad"),r=i("7b0b"),a=i("50c4"),o=i("65f0"),c=[].push,h=function(t){var e=1==t,i=2==t,h=3==t,l=4==t,u=6==t,f=5==t||u;return function(d,_,p,v){for(var g,m,x=r(d),b=s(x),y=n(_,p,3),w=a(b.length),C=0,S=v||o,R=e?S(d,w):i?S(d,0):void 0;w>C;C++)if((f||C in b)&&(g=b[C],m=y(g,C,x),t))if(e)R[C]=m;else if(m)switch(t){case 3:return!0;case 5:return g;case 6:return C;case 2:c.call(R,g)}else if(l)return!1;return u?-1:h||l?l:R}};t.exports={forEach:h(0),map:h(1),filter:h(2),some:h(3),every:h(4),find:h(5),findIndex:h(6)}},c04e:function(t,e,i){var n=i("861d");t.exports=function(t,e){if(!n(t))return t;var i,s;if(e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;if("function"==typeof(i=t.valueOf)&&!n(s=i.call(t)))return s;if(!e&&"function"==typeof(i=t.toString)&&!n(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},c430:function(t,e){t.exports=!1},c6b6:function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},c6cd:function(t,e,i){var n=i("da84"),s=i("ce4e"),r="__core-js_shared__",a=n[r]||s(r,{});t.exports=a},c8ba:function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(n){"object"===typeof window&&(i=window)}t.exports=i},ca84:function(t,e,i){var n=i("5135"),s=i("fc6a"),r=i("4d64").indexOf,a=i("d012");t.exports=function(t,e){var i,o=s(t),c=0,h=[];for(i in o)!n(a,i)&&n(o,i)&&h.push(i);while(e.length>c)n(o,i=e[c++])&&(~r(h,i)||h.push(i));return h}},cc12:function(t,e,i){var n=i("da84"),s=i("861d"),r=n.document,a=s(r)&&s(r.createElement);t.exports=function(t){return a?r.createElement(t):{}}},ce4e:function(t,e,i){var n=i("da84"),s=i("9112");t.exports=function(t,e){try{s(n,t,e)}catch(i){n[t]=e}return e}},d012:function(t,e){t.exports={}},d039:function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},d066:function(t,e,i){var n=i("428f"),s=i("da84"),r=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?r(n[t])||r(s[t]):n[t]&&n[t][e]||s[t]&&s[t][e]}},d1e7:function(t,e,i){"use strict";var n={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,r=s&&!n.call({1:2},1);e.f=r?function(t){var e=s(this,t);return!!e&&e.enumerable}:n},da84:function(t,e,i){(function(e){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof e&&e)||Function("return this")()}).call(this,i("c8ba"))},e893:function(t,e,i){var n=i("5135"),s=i("56ef"),r=i("06cf"),a=i("9bf2");t.exports=function(t,e){for(var i=s(e),o=a.f,c=r.f,h=0;h<i.length;h++){var l=i[h];n(t,l)||o(t,l,c(e,l))}}},e8b5:function(t,e,i){var n=i("c6b6");t.exports=Array.isArray||function(t){return"Array"==n(t)}},f772:function(t,e,i){var n=i("5692"),s=i("90e3"),r=n("keys");t.exports=function(t){return r[t]||(r[t]=s(t))}},fb15:function(t,e,i){"use strict";if(i.r(e),"undefined"!==typeof window){var n=window.document.currentScript,s=i("8875");n=s(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:s});var r=n&&n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);r&&(i.p=r[1])}var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{ref:"audioMotion"})},o=[];i("4160"),i("b0c0"),i("159b");
/*!
 * audioMotion-analyzer
 * High-resolution real-time graphic audio spectrum analyzer JS module
 *
 * @version 2.1.0
 * @author  Henrique Avila Vianna <hvianna@gmail.com> <https://henriquevianna.com>
 * @license AGPL-3.0-or-later
 */
const c="2.1.0";class h{constructor(t,e={}){this._initDone=!1;const i={mode:0,fftSize:8192,minFreq:20,maxFreq:22e3,smoothing:.5,gradient:"classic",minDecibels:-85,maxDecibels:-25,showBgColor:!0,showLeds:!1,showScale:!0,showPeaks:!0,showFPS:!1,lumiBars:!1,loRes:!1,reflexRatio:0,reflexAlpha:.15,reflexFit:!0,lineWidth:0,fillAlpha:1,barSpace:.1,start:!0};this._gradients={classic:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )",{pos:.6,color:"hsl( 60, 100%, 50% )"},"hsl( 120, 100%, 50% )"]},prism:{bgColor:"#111",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )"]},rainbow:{bgColor:"#111",dir:"h",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 47% )","hsl( 240, 100%, 58% )","hsl( 300, 100%, 50% )","hsl( 360, 100%, 50% )"]}},this._container=t||document.body,this._defaultWidth=this._container.clientWidth||640,this._defaultHeight=this._container.clientHeight||270;const n=window.AudioContext||window.webkitAudioContext;if(e.hasOwnProperty("audioCtx")){if(!(e.audioCtx instanceof n))throw new l("ERR_INVALID_AUDIO_CONTEXT","Provided audio context is not valid");this._audioCtx=e.audioCtx}else try{this._audioCtx=new n}catch(s){throw new l("ERR_AUDIO_CONTEXT_FAIL","Could not create audio context. Web Audio API not supported?")}this._analyzer=this._audioCtx.createAnalyser(),this._audioSource=e.source?this.connectAudio(e.source):void 0,this._analyzer.connect(this._audioCtx.destination),this._canvas=document.createElement("canvas"),this._canvas.style="max-width: 100%;",this._container.appendChild(this._canvas),this._canvasCtx=this._canvas.getContext("2d",{alpha:!1}),this._ledsMask=document.createElement("canvas"),this._ledsCtx=this._ledsMask.getContext("2d"),this._labels=document.createElement("canvas"),this._labelsCtx=this._labels.getContext("2d"),window.addEventListener("resize",()=>{this._width&&this._height||this._setCanvas("resize")}),this._canvas.addEventListener("fullscreenchange",()=>this._setCanvas("fschange")),this._setProperties(e,i),this._initDone=!0,this._setCanvas("create")}get barSpace(){return this._barSpace}set barSpace(t){this._barSpace=Number(t),this._calculateBarSpacePx(),this._createLedMask()}get fftSize(){return this._analyzer.fftSize}set fftSize(t){this._analyzer.fftSize=t,this._dataArray=new Uint8Array(this._analyzer.frequencyBinCount),this._precalculateBarPositions()}get gradient(){return this._gradient}set gradient(t){if(!this._gradients.hasOwnProperty(t))throw new l("ERR_UNKNOWN_GRADIENT",`Unknown gradient: '${t}'`);this._gradient=t}get height(){return this._height}set height(t){this._height=t,this._setCanvas("user")}get width(){return this._width}set width(t){this._width=t,this._setCanvas("user")}get mode(){return this._mode}set mode(t){const e=Number(t);if(!(e>=0&&e<=10&&9!=e))throw new l("ERR_INVALID_MODE","Invalid mode: "+e);this._mode=e,this._precalculateBarPositions(),this._reflexRatio>0&&this._generateGradients()}get loRes(){return this._loRes}set loRes(t){this._loRes=Boolean(t),this._setCanvas("lores")}get lumiBars(){return this._lumiBars}set lumiBars(t){this._lumiBars=Boolean(t),this._reflexRatio>0&&(this._generateGradients(),this._createLedMask())}get reflexRatio(){return this._reflexRatio}set reflexRatio(t){if(t=Number(t),t<0||t>=1)throw new l("ERR_REFLEX_OUT_OF_RANGE","Reflex ratio must be >= 0 and < 1");this._reflexRatio=t,this._generateGradients(),this._createLedMask()}get minFreq(){return this._minFreq}set minFreq(t){if(t<1)throw new l("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=t,this._precalculateBarPositions()}get maxFreq(){return this._maxFreq}set maxFreq(t){if(t<1)throw new l("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._maxFreq=t,this._precalculateBarPositions()}get minDecibels(){return this._analyzer.minDecibels}set minDecibels(t){this._analyzer.minDecibels=t}get maxDecibels(){return this._analyzer.maxDecibels}set maxDecibels(t){this._analyzer.maxDecibels=t}get smoothing(){return this._analyzer.smoothingTimeConstant}set smoothing(t){this._analyzer.smoothingTimeConstant=t}get analyzer(){return this._analyzer}get audioCtx(){return this._audioCtx}get audioSource(){return this._audioSource}get canvas(){return this._canvas}get canvasCtx(){return this._canvasCtx}get dataArray(){return this._dataArray}get fsWidth(){return this._fsWidth}get fsHeight(){return this._fsHeight}get fps(){return this._fps}get isFullscreen(){return document.fullscreenElement?document.fullscreenElement===this._canvas:!!document.webkitFullscreenElement&&document.webkitFullscreenElement===this._canvas}get isOn(){return void 0!==this._animationReq}get pixelRatio(){return this._pixelRatio}get version(){return c}connectAudio(t){const e=this._audioCtx.createMediaElementSource(t);return e.connect(this._analyzer),e}registerGradient(t,e){if("string"!==typeof t||0==t.trim().length)throw new l("ERR_GRADIENT_INVALID_NAME","Gradient name must be a non-empty string");if("object"!==typeof e)throw new l("ERR_GRADIENT_NOT_AN_OBJECT","Gradient options must be an object");if(void 0===e.colorStops||e.colorStops.length<2)throw new l("ERR_GRADIENT_MISSING_COLOR","Gradient must define at least two colors");this._gradients[t]={},void 0!==e.bgColor?this._gradients[t].bgColor=e.bgColor:this._gradients[t].bgColor="#111",void 0!==e.dir&&(this._gradients[t].dir=e.dir),this._gradients[t].colorStops=e.colorStops,this._generateGradients()}setCanvasSize(t,e){this._width=t,this._height=e,this._setCanvas("user")}setFreqRange(t,e){if(t<1||e<1)throw new l("ERR_FREQUENCY_TOO_LOW","Frequency values must be >= 1");this._minFreq=Math.min(t,e),this._maxFreq=Math.max(t,e),this._precalculateBarPositions()}setOptions(t){this._setProperties(t)}setSensitivity(t,e){this._analyzer.minDecibels=Math.min(t,e),this._analyzer.maxDecibels=Math.max(t,e)}toggleAnalyzer(t){const e=this.isOn;return void 0===t&&(t=!e),e&&!t?(cancelAnimationFrame(this._animationReq),this._animationReq=void 0):!e&&t&&(this._frame=this._fps=0,this._time=performance.now(),this._animationReq=requestAnimationFrame(t=>this._draw(t))),this.isOn}toggleFullscreen(){this.isFullscreen?document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen():this._canvas.requestFullscreen?this._canvas.requestFullscreen():this._canvas.webkitRequestFullscreen&&this._canvas.webkitRequestFullscreen()}_calculateBarSpacePx(){this._barSpacePx=Math.min(this._barWidth-1,this._barSpace>0&&this._barSpace<1?this._barWidth*this._barSpace:this._barSpace)}_createLedMask(){if(this._mode%10==0||!this._initDone)return;const t=this._lumiBars?this._canvas.height:this._canvas.height*(1-this._reflexRatio)|0;let e,i=Math.min(6,t/(90*this._pixelRatio)|0);switch(this._mode){case 8:i=Math.min(16,t/(33*this._pixelRatio)|0),e=24;break;case 7:i=Math.min(8,t/(67*this._pixelRatio)|0),e=48;break;case 6:e=64;break;case 5:case 4:e=80;break;case 3:e=96;break;case 2:i=Math.min(4,t/(135*this._pixelRatio)|0),e=128;break;case 1:i=Math.min(3,Math.max(2,t/(180*this._pixelRatio)|0)),e=128}i*=this._pixelRatio,e=Math.min(e,(t+i)/(2*i)|0),this._ledOptions={nLeds:e,spaceH:this._barWidth*(1==this._mode?.45:this._mode<5?.225:.125),spaceV:i,ledHeight:(t+i)/e-i};const n=Math.max(this._ledOptions.spaceH,this._barSpacePx);this._ledsMask.width|=0,this._analyzerBars.forEach(e=>this._ledsCtx.fillRect(e.posX-n/2,0,n,t)),this._ledsCtx.fillRect(this._analyzerBars[this._analyzerBars.length-1].posX+this._barWidth-n/2,0,n,t);for(let s=this._ledOptions.ledHeight;s<t;s+=this._ledOptions.ledHeight+this._ledOptions.spaceV)this._ledsCtx.fillRect(0,s,this._canvas.width,this._ledOptions.spaceV)}_draw(t){const e=this._mode%10!=0,i=this.showLeds&&e,n=this._lumiBars&&e,s=this._canvas.height*(1-this._reflexRatio)|0;this.showBgColor?this._canvasCtx.fillStyle=i?"#111":this._gradients[this._gradient].bgColor:this._canvasCtx.fillStyle="#000",this._canvasCtx.fillRect(0,0,this._canvas.width,this._canvas.height),this._analyzer.getByteFrequencyData(this._dataArray),this._canvasCtx.fillStyle=this._gradients[this._gradient].gradient,10==this._mode&&(this._canvasCtx.beginPath(),this._canvasCtx.moveTo(-this.lineWidth,s));let r,a,o=this._barWidth-(e?Math.max(i?this._ledOptions.spaceH:0,this._barSpacePx):0);0!=this._barSpace||i||(o|=0);const c=this._analyzerBars.length;for(let l=0;l<c;l++){if(r=this._analyzerBars[l],0==r.endIdx)a=this._dataArray[r.dataIdx],r.factor&&(a+=(this._dataArray[r.dataIdx+1]-a)*r.factor);else{a=0;for(let t=r.dataIdx;t<=r.endIdx;t++)a=Math.max(a,this._dataArray[t])}n&&(this._canvasCtx.globalAlpha=a/255),a=i?(a/255*this._ledOptions.nLeds|0)*(this._ledOptions.ledHeight+this._ledOptions.spaceV)-this._ledOptions.spaceV:a/255*s|0,a>=r.peak&&(r.peak=a,r.hold=30,r.accel=0);let t=r.posX,e=o;10==this._mode?this._canvasCtx.lineTo(r.posX,s-a):(this._mode>0&&(i?t+=Math.max(this._ledOptions.spaceH/2,this._barSpacePx/2):0==this._barSpace?(t|=0,l>0&&t>this._analyzerBars[l-1].posX+o&&(t--,e++)):t+=this._barSpacePx/2),n?(this._canvasCtx.fillRect(t,0,e,this._canvas.height),this._canvasCtx.globalAlpha=1):this._canvasCtx.fillRect(t,s,e,-a)),r.peak>0&&(this.showPeaks&&!n&&(i?this._canvasCtx.fillRect(t,(this._ledOptions.nLeds-r.peak/(s+this._ledOptions.spaceV)*this._ledOptions.nLeds|0)*(this._ledOptions.ledHeight+this._ledOptions.spaceV),o,this._ledOptions.ledHeight):this._canvasCtx.fillRect(t,s-r.peak,e,2)),r.hold?r.hold--:(r.accel++,r.peak-=r.accel))}if(10==this._mode?(this._canvasCtx.lineTo(r.posX+this.lineWidth,s),this.lineWidth>0&&(this._canvasCtx.lineWidth=this.lineWidth,this._canvasCtx.strokeStyle=this._canvasCtx.fillStyle,this._canvasCtx.stroke()),this.fillAlpha>0&&(this._canvasCtx.globalAlpha=this.fillAlpha,this._canvasCtx.fill(),this._canvasCtx.globalAlpha=1)):i&&this._canvasCtx.drawImage(this._ledsMask,0,0),this._reflexRatio>0&&!n){let t,e;this.reflexFit?(t=0,e=this._canvas.height-s):(t=this._canvas.height-2*s,e=s),this._canvasCtx.fillStyle="#000",this._canvasCtx.fillRect(0,s,this._canvas.width,this._canvas.height-s),this._canvasCtx.globalAlpha=this.reflexAlpha,this._canvasCtx.setTransform(1,0,0,-1,0,this._canvas.height),this._canvasCtx.drawImage(this._canvas,0,0,this._canvas.width,s,0,t,this._canvas.width,e),this._canvasCtx.globalAlpha=1,this._canvasCtx.setTransform()}this.showScale&&this._canvasCtx.drawImage(this._labels,0,this._canvas.height-this._labels.height),this._frame++;const h=t-this._time;if(h>=1e3&&(this._fps=this._frame/(h/1e3),this._frame=0,this._time=t),this.showFPS){const t=20*this._pixelRatio;this._canvasCtx.font=`bold ${t}px sans-serif`,this._canvasCtx.fillStyle="#0f0",this._canvasCtx.textAlign="right",this._canvasCtx.fillText(Math.round(this._fps),this._canvas.width-t,2*t)}this.onCanvasDraw&&(this._canvasCtx.save(),this.onCanvasDraw(this),this._canvasCtx.restore()),this._animationReq=requestAnimationFrame(t=>this._draw(t))}_findFrequencyBin(t,e){const i=t*this._analyzer.fftSize/this._audioCtx.sampleRate;return["floor","ceil"].includes(e)||(e="round"),Math[e](i)}_findBinFrequency(t){return t*this._audioCtx.sampleRate/this._analyzer.fftSize}_generateGradients(){let t;const e=this._lumiBars&&this._mode%10?this._canvas.height:this._canvas.height*(1-this._reflexRatio)|0;Object.keys(this._gradients).forEach(i=>{t=this._gradients[i].dir&&"h"==this._gradients[i].dir?this._canvasCtx.createLinearGradient(0,0,this._canvas.width,0):this._canvasCtx.createLinearGradient(0,0,0,e),this._gradients[i].colorStops&&this._gradients[i].colorStops.forEach((e,n)=>{"object"==typeof e?t.addColorStop(e.pos,e.color):t.addColorStop(n/(this._gradients[i].colorStops.length-1),e)}),this._gradients[i].gradient=t})}_precalculateBarPositions(){if(!this._initDone)return;let t,e;if(this._analyzerBars=[],this._mode%10==0){this._barWidth=1,t=Math.log10(this._minFreq),e=this._canvas.width/(Math.log10(this._maxFreq)-t);const i=this._findFrequencyBin(this._minFreq,"floor"),n=Math.min(this._findFrequencyBin(this._maxFreq),this._analyzer.frequencyBinCount-1);let s=-999;for(let r=i;r<=n;r++){let i=this._findBinFrequency(r),n=Math.round(e*(Math.log10(i)-t));n>s?(this._analyzerBars.push({posX:n,dataIdx:r,endIdx:0,factor:0,peak:0,hold:0,accel:0}),s=n):this._analyzerBars.length&&(this._analyzerBars[this._analyzerBars.length-1].endIdx=r)}}else{let i;i=8==this._mode?24:7==this._mode?12:6==this._mode?8:5==this._mode?6:this._mode;const n=2**(1/24),s=440*n**-114;let r,a=[],o=0;while((r=s*n**o)<=this._maxFreq)r>=this._minFreq&&o%i==0&&a.push(r),o++;t=Math.log10(a[0]),e=this._canvas.width/(Math.log10(a[a.length-1])-t),this._barWidth=this._canvas.width/a.length,this._calculateBarSpacePx();let c=0,h=-1,l=0;a.forEach((t,e)=>{const i=this._findFrequencyBin(t);let n,s;if(n=c>0&&c+1<=i?c+1:i,n==h)l++;else{if(l>1)for(let t=1;t<=l;t++)this._analyzerBars[this._analyzerBars.length-t].factor=(l-t)/l;h=n,l=1}c=s=i,void 0!==a[e+1]&&(s=this._findFrequencyBin(a[e+1]),s-i>1&&(c+=Math.round((s-i)/2)));const r=c-n>0?c:0;this._analyzerBars.push({posX:e*this._barWidth,dataIdx:n,endIdx:r,factor:0,peak:0,hold:0,accel:0})})}this._createLedMask(),this._labels.width|=0,this._labelsCtx.fillStyle="#000c",this._labelsCtx.fillRect(0,0,this._labels.width,this._labels.height),this._labelsCtx.fillStyle="#fff",this._labelsCtx.font=this._labels.height/2+"px sans-serif",this._labelsCtx.textAlign="center";const i=[16,31,63,125,250,500,1e3,2e3,4e3,8e3,16e3];for(const n of i)this._labelsCtx.fillText(n>=1e3?n/1e3+"k":n,e*(Math.log10(n)-t),.75*this._labels.height)}_setCanvas(t){this._initDone&&(this._pixelRatio=window.devicePixelRatio,this._loRes&&(this._pixelRatio/=2),this._fsWidth=Math.max(window.screen.width,window.screen.height)*this._pixelRatio,this._fsHeight=Math.min(window.screen.height,window.screen.width)*this._pixelRatio,this.isFullscreen?(this._canvas.width=this._fsWidth,this._canvas.height=this._fsHeight):(this._canvas.width=(this._width||this._container.clientWidth||this._defaultWidth)*this._pixelRatio,this._canvas.height=(this._height||this._container.clientHeight||this._defaultHeight)*this._pixelRatio),2==this._pixelRatio&&window.screen.height<=540&&(this._pixelRatio=1),this._canvasCtx.fillStyle="#000",this._canvasCtx.fillRect(0,0,this._canvas.width,this._canvas.height),this._canvasCtx.lineJoin="bevel",this._generateGradients(),this._ledsMask.width=this._canvas.width,this._ledsMask.height=this._canvas.height,this._labels.width=this._canvas.width,this._labels.height=this._pixelRatio*(this.isFullscreen?40:20),this._precalculateBarPositions(),this.onCanvasResize&&this.onCanvasResize(t,this))}_setProperties(t,e){const i=["onCanvasDraw","onCanvasResize"],n=["audioCtx","start"];e&&(t=Object.assign(e,t));for(const s of Object.keys(t))-1!==i.indexOf(s)&&"function"!==typeof t[s]?this[s]=void 0:-1===n.indexOf(s)&&(this[s]=t[s]);void 0!==t.start&&this.toggleAnalyzer(t.start)}}class l extends Error{constructor(t,e){super(e),this.name="AudioMotionError",this.code=t}}var u={props:["stream","options","customGradients"],data:function(){return{audioMotionObj:null}},mounted:function(){this.audioMotionElement=this.$refs.audioMotion},watch:{stream:function(){var t=this;if(this.stream&&this.stream.getAudioTracks().length){var e=new AudioContext;e.createMediaStreamSource(this.stream);this.audioMotionObj=new h(this.audioMotionElement),this.customGradients&&(this.customGradients.forEach((function(e){t.audioMotionObj.registerGradient(e.name,e.options)})),this.audioMotionObj.setOptions(this.options));var i=this.audioMotionObj.audioCtx.createMediaStreamSource(this.stream);i.connect(this.audioMotionObj.analyzer)}}},methods:{getAudioMotion:function(){return this.audioMotionObj}}},f=u;function d(t,e,i,n,s,r,a,o){var c,h="function"===typeof t?t.options:t;if(e&&(h.render=e,h.staticRenderFns=i,h._compiled=!0),n&&(h.functional=!0),r&&(h._scopeId="data-v-"+r),a?(c=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},h._ssrRegister=c):s&&(c=o?function(){s.call(this,this.$root.$options.shadowRoot)}:s),c)if(h.functional){h._injectStyles=c;var l=h.render;h.render=function(t,e){return c.call(e),l(t,e)}}else{var u=h.beforeCreate;h.beforeCreate=u?[].concat(u,c):[c]}return{exports:t,options:h}}var _=d(f,a,o,!1,null,null,null),p=_.exports,v=p;e["default"]=v},fc6a:function(t,e,i){var n=i("44ad"),s=i("1d80");t.exports=function(t){return n(s(t))}},fdbc:function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},fdbf:function(t,e,i){var n=i("4930");t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator}})}));
//# sourceMappingURL=vue-audiomotion.umd.min.js.map